<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 
	*변경사항*
	mapper 파일의 완전한 경로 . xml은 생략
	ibatis와는 다르게 id값에 '.'를 사용하지 못함
 -->
<mapper namespace="config.SearchList">

	<select id="selectTourList" parameterType="java.util.Map" resultType="contentDTO">
		select * from
		(select a.*,rownum r from
          	  (select c.*, c2.kor as cat2kor , c3.kor as cat3kor 
          	  from content c, cat2 c2, cat3 c3  
           	where  c.cat2=c2.cat2 and c.cat3 = c3.cat3 and contenttype=12 
           		 <if test="areacode != null ">
           		 and areacode = #{areacode}
           		 </if>
           		 <if test="searchColumn !=null">
           		 	and ${searchColumn} like '%' || #{searchWord} || '%'
           		 </if>
           		  order by
           		 <if test="orderColumn != null">
           		 	  title asc,
           		 </if>
           		 viewcount desc) a )
		where r  between #{start} and #{end}
	</select>
	
	
	<select id="selectFoodList" parameterType="java.util.Map" resultType="contentDTO">
		select * from
		(select a.*,rownum r from
          	  (select c.*, c2.kor as cat2kor , c3.kor as cat3kor from content c, cat2 c2, cat3 c3  
           		 where c.cat2=c2.cat2 and c.cat3 = c3.cat3 and contenttype=39
           		 <if test="areacode != null ">
           		 and areacode = #{areacode}
           		 </if>
           		
           		  <if test="searchColumn !=null">
           		 	and ${searchColumn} like '%' || #{searchWord} || '%'
           		 </if>
           		  order by
           		 <if test="orderColumn != null">
           		 	  title asc,
           		 </if>
           		
           		 viewcount desc)   a )
		where r  between #{start} and #{end}
	</select>
	
	<select id="selectSleepList" parameterType="java.util.Map" resultType="contentDTO">
		select * from
			(select a.*,rownum r from
          	  (select c.*, c2.kor as cat2kor , c3.kor as cat3kor from content c, cat2 c2, cat3 c3  
           		 where c.cat2=c2.cat2 and c.cat3 = c3.cat3 and contenttype=32
           		 <if test="areacode != null ">
           		 and areacode = #{areacode}
           		 </if>
           		  <if test="searchColumn !=null">
           		 	and ${searchColumn} like '%' || #{searchWord} || '%'
           		 </if>
           		  order by
           		 <if test="orderColumn != null">
           		 	  title asc,
           		 </if>
           		 viewcount desc)   a )
		where r  between #{start} and #{end}
	</select>
	
	<select id="getTotalCount" parameterType="java.util.Map" resultType="int">
		select count(*) from content where contenttype=#{contenttype}
		<if test="searchWord != null">
				and ${searchColumn} LIKE '%' || #{searchWord} || '%'
		</if>
		<if test="areacode != null">
           		 and areacode=#{areacode}
        </if>
        order by
        <if test="orderColumn != null">
            #{orderColumn} desc,
        </if>
        viewcount desc, contentid desc
	</select>
	
	<select id="searchSelectList" parameterType="java.util.Map" resultType="contentDTO">
		select * from
		(select a.*,rownum r from(
		select * from content where contenttype=12)a)
		where  r between #{start} and #{end}
	</select>

	
	
	

	
	
	
	
	
</mapper>